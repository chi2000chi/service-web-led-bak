<?xml version="1.0" encoding="UTF-8" ?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" ><mapper namespace="com.framework.webClient.dao.LedTemplateTempDao" ><sql id="sql_select">		<![CDATA[			SELECT				T.MBID AS "mbid",				T.GGMC AS "ggmc",				T.MBLJ AS "mblj",				TO_CHAR (T.FBSJ, 'YYYY-MM-DD hh24:mi') AS "fbsj",				TO_CHAR (T.JZSJ, 'YYYY-MM-DD hh24:mi') AS "jzsj",				TO_CHAR (T.CJSJ, 'YYYY-MM-DD') AS "cjsj",				T.CJR AS "cjr",				TO_CHAR (T.XGSJ, 'YYYY-MM-DD') AS "xgsj",				T.XGR AS "xgr",				T.BZ AS "bz"			FROM				LED_TEMPLATE_TEMP T		]]>	</sql>	<select id="selectLedTemplateTempByInfo"  resultType="map" parameterType="map" >		<include refid="sql_select"></include>		<where>			<if test=" mbid != null and  mbid != '' ">				AND T.MBID = #{mbid}			</if>			<if test=" ggmc != null and  ggmc != '' ">				AND T.GGMC LIKE '%'||#{ggmc}||'%' 			</if>			<if test=" fbsj != null and  fbsj != '' ">				AND TO_CHAR (T.FBSJ, 'YYYY-MM-DD') >= #{fbsj}			</if>			<if test=" jzsj != null and  jzsj != '' ">				AND TO_CHAR (T.FBSJ, 'YYYY-MM-DD') <![CDATA[ <= ]]>  #{jzsj}			</if>			<if test=" ggmc != null and  ggmc != '' and tag != null and tag != '' ">				AND T.GGMC = #{ggmc}			</if>		</where>	</select>		<select id="selectGgszByMbidAndFqlx" parameterType="map" resultType="map">	SELECT			ledTemp.MBID AS "mbid",			ledTemp.GGMC AS "ggmc",			TO_CHAR(ledTemp.FBSJ, 'YYYY-MM-DD hh24:mi') AS "fbsj",			TO_CHAR(ledTemp.JZSJ, 'YYYY-MM-DD hh24:mi') AS "jzsj",			TO_CHAR(ledTemp.CJSJ, 'YYYY-MM-DD') AS "cjsj",			ledTemp.CJR AS "cjr",			TO_CHAR(ledTemp.XGSJ, 'YYYY-MM-DD') AS "xgsj",			ledTemp.XGR AS "xgr",			ledTemp.MBLJ AS "mblj",			ledTempArea.FQID AS "fqid",			ledArea.FQLX AS "fqlx",			ledSjzd.ZDMC AS "fqlxmc",			ledArea.wjid AS "wjid",			ledAreaAttr.SXID AS "pzid",			ledAreaAttr.SXMC AS "csmc",			ledAreaAttr.SXZ AS "cssz",			ledAreaAttr.WJID AS "cswj"		FROM			LED_TEMPLATE_TEMP ledTemp		JOIN LED_TEMPLATE_AREA ledTempArea ON LEDTEMP.MBID = LEDTEMPAREA.MBID		JOIN LED_AREA ledArea ON ledTempArea.FQID = ledArea.FQID		JOIN LED_AREA_ATTR ledAreaAttr ON ledArea.FQID = ledAreaAttr.FQID		JOIN LED_SJZD ledSjzd ON ledSjzd.pzdbm = '4' AND ledArea.FQLX = ledSjzd.zdbm				where LEDTEMP.MBID = #{mbid} and ledArea.FQID = #{fqid}		UNION ALL			SELECT				ledTemp.MBID AS "mbid",				ledTemp.GGMC AS "ggmc",				TO_CHAR(ledTemp.FBSJ, 'YYYY-MM-DD hh24:mi') AS "fbsj",				TO_CHAR(ledTemp.JZSJ, 'YYYY-MM-DD hh24:mi') AS "jzsj",				TO_CHAR(ledTemp.CJSJ, 'YYYY-MM-DD') AS "cjsj",				ledTemp.CJR AS "cjr",				TO_CHAR(ledTemp.XGSJ, 'YYYY-MM-DD') AS "xgsj",				ledTemp.XGR AS "xgr",				ledTemp.MBLJ AS "mblj",				ledTempArea.FQID AS "fqid",				ledArea.FQLX AS "fqlx",				ledSjzd.ZDMC AS "fqlxmc",				ledArea.wjid AS "wjid",				ledAreaCommonset.PZID AS "pzid",				ledAreaCommonset.PZMC AS "csmc",				ledAreaCommonset.PZZ AS "cssz",				ledAreaCommonset.WJID AS "cswj"			FROM				LED_TEMPLATE_TEMP ledTemp			JOIN LED_TEMPLATE_AREA ledTempArea ON LEDTEMP.MBID = LEDTEMPAREA.MBID			JOIN LED_AREA ledArea ON ledTempArea.FQID = ledArea.FQID			JOIN LED_AREA_COMMONSET ledAreaCommonset ON ledArea.FQID = ledAreaCommonset.FQID			JOIN LED_SJZD ledSjzd ON ledSjzd.pzdbm = '4' AND ledArea.FQLX = ledSjzd.zdbm				where LEDTEMP.MBID = #{mbid} and ledArea.FQID = #{fqid}					</select>	<select id="selectFileidTempByMbidAndFqlx" resultType="String" parameterType="map">		SELECT DISTINCT			ledAreaFile.WJID AS "fileid"		FROM			LED_TEMPLATE_TEMP ledTemp		JOIN LED_TEMPLATE_AREA ledTempArea ON LEDTEMP.MBID = LEDTEMPAREA.MBID		JOIN LED_AREA ledArea ON ledTempArea.FQID = ledArea.FQID		JOIN LED_AREA_FILE ledAreaFile ON ledArea.FQID = ledAreaFile.FQID		JOIN LED_AREA_FILE_ATTR ledAreaFileAttr ON ledAreaFile.WJID = ledAreaFileAttr.WJID		where LEDTEMP.MBID = #{mbid} and ledArea.FQID = #{fqid}	</select>		<select id="selectFileInfoTempByMbidAndFqlx" parameterType="map" resultType="map">	SELECT			ledTemp.MBID AS "mbid",			ledTemp.GGMC AS "ggmc",			TO_CHAR(ledTemp.FBSJ, 'YYYY-MM-DD hh24:mi') AS "fbsj",			TO_CHAR(ledTemp.JZSJ, 'YYYY-MM-DD hh24:mi') AS "jzsj",			TO_CHAR(ledTemp.CJSJ, 'YYYY-MM-DD') AS "cjsj",			ledTemp.CJR AS "cjr",			TO_CHAR(ledTemp.XGSJ, 'YYYY-MM-DD') AS "xgsj",			ledTemp.XGR AS "xgr",			ledTemp.MBLJ AS "mblj",			ledTempArea.FQID AS "fqid",			ledArea.FQLX AS "fqlx",			ledArea.wjid AS "wjid",			ledAreaFile.WJID AS "fileid",			ledAreaFile.XH AS "xh",			ledAreaFileAttr.SXMC AS "csmc",			ledAreaFileAttr.SXZ AS "cssz"		FROM			LED_TEMPLATE_TEMP ledTemp		JOIN LED_TEMPLATE_AREA ledTempArea ON LEDTEMP.MBID = LEDTEMPAREA.MBID		JOIN LED_AREA ledArea ON ledTempArea.FQID = ledArea.FQID		JOIN LED_AREA_FILE ledAreaFile ON ledArea.FQID = ledAreaFile.FQID		JOIN LED_AREA_FILE_ATTR ledAreaFileAttr ON ledAreaFile.WJID = ledAreaFileAttr.WJID			where LEDTEMP.MBID = #{mbid} and ledArea.FQID = #{fqid}	</select>		<insert id="insertLedTempTemplate" parameterType="map" >		INSERT INTO LED_TEMPLATE_TEMP (			MBID,			GGMC,			FBSJ,			JZSJ,			MBLJ,			CJSJ,			CJR,			XGSJ,			XGR			<if test="bz != null and bz != ''">				,BZ			</if>			)  VALUES  (			'${mbid}',			'${ggmc}',			to_date('${fbsj}', 'YYYY-MM-dd HH24:MI:SS'),			to_date('${jzsj}', 'YYYY-MM-dd HH24:MI:SS'),			'${mblj}',			sysdate,			'${cjr}',			sysdate,			'${xgr}'			<if test="bz != null and bz != ''">				,'${bz}'			</if>			)	</insert>	<update id="updateLedTemplateTempById"  parameterType="map" >		UPDATE  LED_TEMPLATE_TEMP SET 			GGMC = '${ggmc}',			FBSJ = to_date('${fbsj}','YYYY-MM-dd hh24:mi:ss'),			JZSJ = to_date('${jzsj}','YYYY-MM-dd hh24:mi:ss'),			MBLJ = '${mblj}',			XGSJ = sysdate,			XGR = '${xgr}'			<if test="bz != null and bz != ''">				,BZ = '${bz}'			</if>		WHERE MBID = #{mbid} 	</update>	<delete id="deleteLedTemplateTempById"  parameterType="string" >		delete from  LED_TEMPLATE_TEMP  WHERE MBID = #{mbid} 	</delete>		<update id="updateLedTemplateTempFbsjByMbid"  parameterType="map" >		UPDATE  LED_TEMPLATE_TEMP SET 			FBSJ =sysdate,			XGSJ = sysdate,			XGR = '${xgr}'		WHERE MBID = #{mbid} 	</update></mapper>