package com.framework.webClient.controller;import java.util.ArrayList;import java.util.HashMap;import java.util.List;import java.util.Map;import javax.servlet.http.HttpServletResponse;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.PostMapping;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestParam;import org.springframework.web.bind.annotation.RestController;import org.springframework.web.servlet.ModelAndView;import com.framework.webClient.service.ILedStateManageService;import com.framework.webClient.util.ConstantUtil;import com.framework.webClient.util.ExportExcelUtil;/** * @author 吉庆 * @date Mon Sep 03 00:00:00 CST 2018 */@RestControllerpublic class LedStateController {	@Autowired	private ILedStateManageService   ledstatemanageservice;	/**	 * 	 * 初始化	 * @return	 */	@RequestMapping("/ledstate")	public ModelAndView ledstate() {		ModelAndView mv = new ModelAndView("ledstate");		return mv;	}		/**	 * 	 * 加载列表	 * @param paramMap	 * @return	 */	@PostMapping(value = "/selectLedStateInfo")	public List<Map<String, Object>> selectLedStateInfo(@RequestParam Map<String, Object> paramMap){		try {			return ledstatemanageservice.selectLedStateInfo(paramMap);		} catch (Exception e) {			e.printStackTrace();			return null;		}	}	/**	 * 	 * 导出排班与计划类型匹配	 * @param xlid 线路ID	 * @param date 年月日	 * @param response	 */	@GetMapping(value = "/exportledstate")	public void exportLedStateExcel(@RequestParam  Map<String, Object> paramMap, HttpServletResponse response) {		List<Map<String, Object>> ledStateList = ledstatemanageservice.selectLedStateInfo(paramMap);		// 数据整合导出		List<Map<String, Object>> resultList = new ArrayList<>();		// 电子站牌信息		Map<String, Object> ledStateMap = new HashMap<>();		ledStateMap.put("ledmc", "站牌名称");		ledStateMap.put("ledbh", "站牌编号");		ledStateMap.put("sbzt", "设备状态");		ledStateMap.put("jssj", "接收时间");		// 整理数据，添加导出列		ledStateList.add(0, ledStateMap);		// 电子站牌状态title		List<String> ledStateTitleList = new ArrayList<>();		ledStateTitleList.add("ledmc");		ledStateTitleList.add("ledbh");		ledStateTitleList.add("sbzt");		ledStateTitleList.add("jssj");				Map<String, Object> stateMap = new HashMap<>();		stateMap.put("titleList", ledStateTitleList);		stateMap.put("dataList", ledStateList);		stateMap.put(ConstantUtil.SHEETNAME, "电子站牌状态列表");		resultList.add(stateMap);		ExportExcelUtil.excel(resultList, null, null, response);	}}